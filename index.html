<!DOCTYPE html>
<html>
<head>
  <title>Google Sheet Editor</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f4f4f4;
    }
    input {
      width: 100%;
      border: none;
      padding: 5px;
    }
  </style>
</head>
<body>
  <h1>Editable Google Sheet</h1>
  <table id="data-table">
    <thead></thead>
    <tbody></tbody>
  </table>

  <script>
    // Fetch data from the sheet
    google.script.run.withSuccessHandler(renderTable).getSheetData();

    function renderTable(data) {
      const table = document.getElementById('data-table');
      const thead = table.querySelector('thead');
      const tbody = table.querySelector('tbody');

      // Clear previous content
      thead.innerHTML = '';
      tbody.innerHTML = '';

      // Create header row
      const headerRow = document.createElement('tr');
      data[0].forEach(header => {
        const th = document.createElement('th');
        th.textContent = header;
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);

      // Create rows
      data.slice(1).forEach((row, rowIndex) => {
        const tr = document.createElement('tr');
        row.forEach((cell, colIndex) => {
          const td = document.createElement('td');
          const input = document.createElement('input');
          input.type = 'text';
          input.value = cell;
          input.dataset.row = rowIndex;
          input.dataset.col = colIndex;

          // Add change event
          input.addEventListener('change', function () {
            const newValue = this.value;
            const row = parseInt(this.dataset.row, 10);
            const col = parseInt(this.dataset.col, 10);
            google.script.run.updateSheetData(row + 1, col + 1, newValue);
          });

          td.appendChild(input);
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }
  </script>
</body>
</html>
