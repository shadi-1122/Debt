<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Sheet Editor</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f4f4f4;
    }
    input {
      width: 100%;
      border: none;
      padding: 5px;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <h1>Google Sheet Editor</h1>
  <table id="sheet-data">
    <thead></thead>
    <tbody></tbody>
  </table>
  
  <script>
    // Fetch Google Sheet data and render it as an editable table
    google.script.run.withSuccessHandler(renderTable).getSheetData();

    function renderTable(data) {
      const tableHead = document.querySelector('#sheet-data thead');
      const tableBody = document.querySelector('#sheet-data tbody');

      // Clear existing content
      tableHead.innerHTML = '';
      tableBody.innerHTML = '';

      // Render table headers
      const headers = data[0];
      const headerRow = document.createElement('tr');
      headers.forEach(header => {
        const th = document.createElement('th');
        th.textContent = header;
        headerRow.appendChild(th);
      });
      tableHead.appendChild(headerRow);

      // Render table rows with editable cells
      for (let i = 1; i < data.length; i++) {
        const row = document.createElement('tr');
        data[i].forEach((cell, j) => {
          const td = document.createElement('td');
          const input = document.createElement('input');
          input.type = 'text';
          input.value = cell;
          input.dataset.row = i;
          input.dataset.col = j;
          input.addEventListener('change', handleInputChange);
          td.appendChild(input);
          row.appendChild(td);
        });
        tableBody.appendChild(row);
      }
    }

    function handleInputChange(event) {
      const input = event.target;
      const row = parseInt(input.dataset.row, 10);
      const col = parseInt(input.dataset.col, 10);
      const value = input.value;

      // Send updated value to Google Sheet
      google.script.run.updateSheetData(row, col, value);
    }
  </script>
</body>
</html>
